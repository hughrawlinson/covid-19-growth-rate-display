{"version":3,"sources":["hooks/useCovidData.js","components/CountrySelector.js","App.js","index.js"],"names":["aggregateDay","day","reduce","acc","el","confirmed","deaths","recovered","date","CountrySelector","countries","selectedCountry","setSelectedCountry","options","map","country","value","label","onChange","Title","Typography","Content","Layout","Header","TALLY_TYPES","Footer","prepareData","data","selectedTallyType","zeroDayMode","growthRateMode","getY","datum","index","previousDay","id","x","y","filter","App","useState","covidData","setCovidData","useEffect","isCurrent","fetch","then","res","json","array","Worldwide","Object","values","col","i","row","keys","sort","useCovidData","covidCountries","setSelectedTallyType","setZeroDayMode","logarithmicMode","setLogarithmicMode","setGrowthRateMode","lineConfig","width","window","innerWidth","height","margin","top","right","bottom","left","animate","enableSlices","enableArea","xScale","type","format","precision","yScale","base","axisBottom","tickValues","legend","legendOffset","document","title","curve","labelCol","span","wrapperCol","Item","name","find","tallyType","event","target","checked","disabled","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ce446c2d.chunk.js","sourcesContent":["import { useState, useEffect } from 'react';\n\nfunction transpose(array) {\n  return array[0].map((col, i) => array.map(row => row[i]));\n}\n\nfunction aggregateDay(day) {\n  return day.reduce((acc, el) => ({\n    ...acc,\n    confirmed: acc.confirmed + el.confirmed,\n    deaths: acc.deaths + el.deaths,\n    recovered: acc.recovered + el.recovered,\n  }), {\n    date: day[0].date,\n    confirmed: 0,\n    deaths: 0,\n    recovered: 0,\n  });\n}\n\nexport function useCovidData() {\n  const COVID_DATA_URL = \"https://pomber.github.io/covid19/timeseries.json\";\n  const [covidData, setCovidData] = useState(null);\n\n  useEffect(() => {\n    let isCurrent = true;\n    fetch(COVID_DATA_URL).then(res => res.json()).then(data => {\n      if (isCurrent) setCovidData(data);\n    });\n    return () => {\n      isCurrent = false;\n    };\n  }, []);\n\n  if (!covidData) {\n    return [null, null];\n  }\n\n  const Worldwide = transpose(Object.values(covidData))\n    .map(aggregateDay);\n\n  return [\n    {\n      Worldwide,\n      ...covidData,\n    },\n    covidData ? ['Worldwide', ...Object.keys(covidData).sort()] : null\n  ];\n}\n\n","import React from 'react';\nimport Select from 'react-select';\n\nexport function CountrySelector({countries, selectedCountry, setSelectedCountry}) {\n  return <Select\n    options={countries.map(country => ({value: country, label: country}))}\n    onChange={value => {\n      setSelectedCountry(value.value)\n    }}\n    value={{\n      value: selectedCountry,\n      label: selectedCountry,\n    }}\n  />;\n}\n","import React, { useState, useEffect } from 'react';\nimport { useCovidData } from './hooks/useCovidData';\nimport { CountrySelector } from './components/CountrySelector';\nimport Select from 'react-select';\nimport { Line } from '@nivo/line';\nimport { Layout, Checkbox, Form, Typography } from 'antd';\nconst { Title } = Typography\nconst { Content, Header, Footer } = Layout;\n\nconst TALLY_TYPES = [{\n  value: \"confirmed\",\n  label: \"Confirmed\"\n},{\n  value: \"deaths\",\n  label: \"Deaths\"\n},{\n  value: \"recovered\",\n  label: \"Recovered\"\n}]\n\nfunction App() {\n  const [covidData, covidCountries] = useCovidData();\n  const [selectedCountry, setSelectedCountry] = useState('Worldwide');\n  const [selectedTallyType, setSelectedTallyType] = useState('confirmed');\n  const [zeroDayMode, setZeroDayMode] = useState(false);\n  const [logarithmicMode, setLogarithmicMode] = useState(false);\n  const [growthRateMode, setGrowthRateMode] = useState(false);\n\n  useEffect(() => {\n    if (covidCountries && !selectedCountry) setSelectedCountry(covidCountries[0]);\n  }, [selectedCountry, covidCountries]);\n\n  const lineConfig = {\n    width: window.innerWidth - 20,\n    height: 400,\n    margin: { top: 20, right: 20, bottom: 60, left: 80},\n    animate: true,\n    enableSlices: 'x',\n    enableArea: true,\n    xScale: {\n      type: 'time',\n      format: '%Y-%m-%d',\n      precision: 'day'\n    },\n    yScale: logarithmicMode ? {\n      type: 'log',\n      base: 10,\n    } : { type: 'linear' },\n    axisBottom: {\n      format: '%b %d',\n      tickValues: 'every 7 days',\n      legend: 'time scale',\n      legendOffset: -12\n    }\n  }\n\n  return (\n    <Layout>\n      <Header>\n      </Header>\n      <Content>\n        <Title>{document.title}</Title>\n        { covidData && (\n          <>\n          <Line\n            curve=\"monotoneX\"\n            data={prepareData({\n              data: covidData,\n              selectedCountry,\n              selectedTallyType,\n              zeroDayMode,\n              growthRateMode\n            })}\n            {...lineConfig}\n          />\n          <Form\n            labelCol={{span: 4}}\n            wrapperCol={{span: 8}}\n          >\n            <Form.Item\n              label=\"Country\"\n              name=\"country\"\n            >\n              <CountrySelector\n                countries={covidCountries}\n                selectedCountry={selectedCountry}\n                setSelectedCountry={setSelectedCountry}\n              />\n            </Form.Item>\n            <Form.Item\n              label=\"Tally Type\"\n              name=\"tally-type\"\n            >\n              <Select\n                options={TALLY_TYPES}\n                value={TALLY_TYPES.find(tallyType => tallyType.value === selectedTallyType)}\n                onChange={tallyType => setSelectedTallyType(tallyType.value)}\n              />\n            </Form.Item>\n            <Form.Item\n              label=\"Zero Day Mode\"\n              name=\"zero-day-mode\"\n            >\n              <Checkbox\n                onChange={event => {\n                  !event.target.checked && setLogarithmicMode(false);\n                  setZeroDayMode(event.target.checked)\n                }}\n                checked={zeroDayMode}\n              >\n                Zero Day Mode\n              </Checkbox>\n            </Form.Item>\n            <Form.Item\n              label=\"Logarithmic Mode\"\n              name=\"logarithmic-mode\"\n            >\n              <Checkbox\n                disabled={!zeroDayMode}\n                onChange={event => {\n                  setLogarithmicMode(event.target.checked)\n                }}\n                checked={logarithmicMode}\n              >\n                Logarithmic\n              </Checkbox>\n            </Form.Item>\n            <Form.Item\n              label=\"Growth Rate Mode\"\n              name=\"growth-rate-mode\"\n            >\n              <Checkbox\n                onChange={event => {\n                  setGrowthRateMode(event.target.checked)\n                }}\n                checked={growthRateMode}\n              >\n                Growth Rate\n              </Checkbox>\n            </Form.Item>\n          </Form>\n          </>\n        )}\n      </Content>\n    </Layout>\n  );\n}\n\nfunction prepareData({data, selectedCountry, selectedTallyType, zeroDayMode, growthRateMode}) {\n  function getY(datum, index) {\n    if (!growthRateMode) {\n      return datum[selectedTallyType];\n    }\n\n    if (index < 1) {\n      return 0;\n    }\n\n    const previousDay = data[selectedCountry][index - 1];\n\n    if (!previousDay) {\n      return datum[selectedTallyType];\n    }\n\n    return (datum[selectedTallyType] - (previousDay[selectedTallyType] || 0)) / (previousDay[selectedTallyType] || 1);\n  }\n\n  return [{\n    id: selectedCountry,\n    data: data[selectedCountry].map((datum, index) => ({\n      x: datum.date,\n      y: getY(datum, index)\n    })).filter(({y}) => !zeroDayMode || y > 0)\n  }]}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'antd/dist/antd.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}